Данный код представляет собой инструмент для автоматизированного планирования территории с учётом ограничений на застройку. Он разделяет доступную для строительства зону на жилую и коммерческую части, генерирует дорогу и визуализирует результат. Ниже приведено подробное описание того, что делает код, для чего он предназначен и как работает.

---

### **Цель кода**
Код предназначен для:
1. **Анализа территории**: загрузка данных о границах участка и ограничениях на строительство.
2. **Разделения территории**: автоматическое разделение доступной для застройки зоны на жилую и коммерческую части с учётом ограничений.
3. **Генерации дороги**: создание дороги, которая не пересекает запрещённые зоны.
4. **Визуализации**: отображение результатов на карте и сохранение их в формате GeoJSON и изображения.

---

### **Основные шаги кода**

1. **Импорт библиотек**:
   - `json` — для работы с GeoJSON-файлами.
   - `geopandas` — для работы с геоданными.
   - `matplotlib.pyplot` — для визуализации.
   - `shapely` — для работы с геометрическими объектами (полигоны, линии и т.д.).
   - `random` — для генерации случайных значений.

2. **Константы**:
   - `MIN_DISTANCE_METERS` — минимальное расстояние между зданиями (в метрах).
   - `DEGREES_PER_METER` — коэффициент перевода метров в градусы (для работы с координатами).
   - `BUILDABLE_PERCENTAGE` — ограничение плотности застройки (например, 50% участка).

3. **Функция `split_buildable_area`**:
   - Разделяет доступную для застройки территорию на жилую и коммерческую зоны.
   - Учитывает ограничения (запрещённые зоны) и плотность застройки.
   - Возвращает два полигона: для жилой и коммерческой зон.

4. **Функция `generate_road`**:
   - Генерирует дорогу в виде линии, которая не пересекает запрещённые зоны.
   - Если дорогу нельзя разместить, возвращает `None`.

5. **Загрузка данных**:
   - Загружает данные из GeoJSON-файла (`input.geojson`).
   - Преобразует данные в формат `GeoDataFrame` для удобной работы.

6. **Обработка данных**:
   - Разделяет данные на запрещённые зоны (`restricted_areas`) и доступную для застройки зону (`buildable_area`).
   - Очищает зону застройки от запрещённых зон.

7. **Разделение территории**:
   - Использует функцию `split_buildable_area` для разделения зоны на жилую и коммерческую части.

8. **Генерация дороги**:
   - Использует функцию `generate_road` для создания дороги.

9. **Создание выходного GeoJSON**:
   - Формирует GeoJSON-файл (`output.geojson`), содержащий жилую зону, коммерческую зону и дорогу.

10. **Визуализация**:
    - Создаёт карту с использованием `matplotlib`.
    - Отображает зону застройки, запрещённые зоны, жилую и коммерческую зоны, а также дорогу.
    - Сохраняет карту в файл `plan.png`.

---

### **Как работает код**

1. **Входные данные**:
   - GeoJSON-файл (`input.geojson`), содержащий границы участка и информацию о запрещённых зонах (например, зоны, где строительство запрещено).

2. **Обработка**:
   - Код анализирует входные данные, выделяет доступную для застройки зону и очищает её от запрещённых участков.
   - Разделяет зону на жилую и коммерческую части, учитывая ограничения на плотность застройки.
   - Генерирует дорогу, которая не пересекает запрещённые зоны.

3. **Выходные данные**:
   - GeoJSON-файл (`output.geojson`) с результатами.
   - Изображение (`plan.png`), визуализирующее зоны и дорогу.

---

### **Для чего используется код**

1. **Градостроительное планирование**:
   - Автоматизация процесса разделения территории на функциональные зоны (жилая, коммерческая).
   - Учёт ограничений на строительство (например, природные зоны, инфраструктура).

2. **Оптимизация застройки**:
   - Контроль плотности застройки для соблюдения нормативов.

3. **Визуализация**:
   - Создание наглядных планов для презентаций или дальнейшего анализа.

4. **Генерация инфраструктуры**:
   - Автоматическое создание дорог с учётом ограничений.

---

### **Пример использования**

1. **Подготовка данных**:
   - Создайте GeoJSON-файл (`input.geojson`) с границами участка и запрещёнными зонами.

2. **Запуск кода**:
   - Запустите скрипт. Он создаст файл `output.geojson` и изображение `plan.png`.

3. **Анализ результатов**:
   - Используйте выходные данные для дальнейшего планирования или презентации.

---

### **Ограничения и улучшения**

1. **Ограничения**:
   - Код не учитывает сложные формы участков (например, участки с множеством "дыр").
   - Генерация дороги может быть улучшена для создания более сложных сетей.

2. **Улучшения**:
   - Добавление поддержки для более сложных ограничений (например, высотные ограничения).
   - Интеграция с GIS-системами для работы с реальными данными.
   - Оптимизация алгоритма разделения территории для более сложных сценариев.

---

Этот код полезен для автоматизации начальных этапов планирования территории, особенно в случаях, когда требуется быстро разделить участок на функциональные зоны с учётом ограничений.
